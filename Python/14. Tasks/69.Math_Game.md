# OOP Math Game
# Save as math_game_oop.py and run

from random import randint
import os
import time
import sys

class MathGame:
    def __init__(self, total_questions=10):
        self.total_questions = total_questions
        self.correct = 0
        self.wrong = 0
        self.level = 2   # default medium
        self.level_name = "Medium"
        self.range_lo = 1
        self.range_hi = 50

    @staticmethod
    def clear_screen():
        if sys.platform.startswith("win"):
            os.system("cls")
        else:
            os.system("clear")

    def choose_level(self):
        mapping = {1: ("Easy", 1, 20), 2: ("Medium", 1, 50), 3: ("Hard", 1, 100)}
        while True:
            try:
                lvl = int(input("Choose Difficulty Level (1=Easy, 2=Medium, 3=Hard): ").strip())
                if lvl in mapping:
                    name, lo, hi = mapping[lvl]
                    self.level, self.level_name, self.range_lo, self.range_hi = lvl, name, lo, hi
                    return
            except ValueError:
                pass
            print("Please enter 1, 2 or 3.")

    @staticmethod
    def _ask_int(prompt="> "):
        while True:
            try:
                return int(input(prompt).strip())
            except ValueError:
                print("Please enter an integer.")

    @staticmethod
    def _grade(score, total):
        if score == total:
            return "A"
        if score >= 7:
            return "B"
        if score >= 5:
            return "C"
        return "D"

    def _generate_question(self):
        a = randint(self.range_lo, self.range_hi)
        b = randint(self.range_lo, self.range_hi)
        c = a + b
        qtype = randint(1, 3)
        if qtype == 1:
            text = f"? + {b} = {c}"
            answer = a
        elif qtype == 2:
            text = f"{a} + ? = {c}"
            answer = b
        else:
            text = f"{a} + {b} = ?"
            answer = c
        return text, answer

    def play(self):
        self.choose_level()
        start = time.perf_counter()

        for i in range(1, self.total_questions + 1):
            self.clear_screen()
            qtext, qans = self._generate_question()
            print(f"Level: {self.level_name}  |  Q {i}/{self.total_questions}  |  Correct: {self.correct}  Wrong: {self.wrong}")
            print("Solve:", qtext)
            user = self._ask_int()
            if user == qans:
                print("Correct! Press Enter to continue...")
                self.correct += 1
                input()
            else:
                print(f"Wrong â€” correct answer was {qans}. Press Enter to continue...")
                self.wrong += 1
                input()

        end = time.perf_counter()
        elapsed = end - start
        grade = self._grade(self.correct, self.total_questions)
        self.clear_screen()
        print("=== Final Report ===")
        print(f"Score : {self.correct}/{self.total_questions} ({self.correct/self.total_questions*100:.1f}%)")
        print(f"Time  : {elapsed:.2f} seconds")
        print(f"Grade : {grade}")


if __name__ == "__main__":
    game = MathGame(total_questions=10)
    game.play()
